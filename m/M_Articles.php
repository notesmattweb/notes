<?phpclass M_Articles{	private static $instance;	private $msql; // драйвер БД			public static function get_instance(){		if(empty(self::$instance)){			self::$instance = new M_Articles();		}		return self::$instance;	}	public function __construct(){		$this->msql = M_MSQL::get_instance();			}		// Список всех статей	public function articles_all($startfrom=null, $limit=null)	{		if(!is_null($startfrom) && !is_null($limit)){			// Запрос.			$query = "SELECT * FROM articles ORDER BY id_article DESC LIMIT $startfrom, $limit";		}		else{			// Запрос.			$query = "SELECT * FROM articles ORDER BY id_article DESC";			}				return $this->msql->Select($query);			}	// Конкретная статья	public function articles_get($id_article)	{		// запрос		$t = "SELECT * FROM `articles` WHERE id_article = %d";				$query = sprintf($t, $id_article);		$result = $this->msql->Select($query);						return $result[0];			}		// Добавить статью	public function articles_new($title, $content)	{		// Подготовка.		$title = trim($title);		$content = trim($content);		// Проверка.		if ($title == '' || $content == '')			return false;				// Запрос.		$obj = array();		$obj['title'] = $title;		$obj['content'] = $content;				$this->msql->Insert('articles', $obj);				return true;	}	// Изменить статью	public function articles_edit($id_article, $title, $content)	{		//подготовка		$title = trim($title);		$content = trim($content);				//проверка			if($title == "" || $content == "" || $id_article == ""){			return false;		}				$obj = array();		$obj['title'] = $title;		$obj['content'] = $content;		$t = "id_article='%d'";		$where = sprintf($t, $id_article);				$this->Update('articles',$obj,$where);				return true;	}	// Удалить статью	public function articles_delete($id_article)	{		if($id_article == ""){return false;}				$t = "id_article='%d'";		$where = sprintf($t, $id_article);				$this->Delete('articles', $where);		return true;	}	// Короткое описание статьи без обрезки слов	public function articles_intro($content, $l)	{		if(strlen($content) > $l){		   // преобразовываем в массив		   $content = str_split($content);		   while(ord($content[$l]) != 32){				--$l;		   } 	   		   // обрезаем массив		   $content = array_slice($content,0,$l);		}			// обратно в строку		return implode("",$content)."...";			}		// Навигация по статьям	public function Make_navbar($curstart = 0, $arperpage = 5){		$query = "SELECT COUNT( id_article ) AS art_quantity FROM `articles";		$result = mysql_query($query);		 if(!$result){			die(mysql_error());		 } 		$art_quant = mysql_fetch_assoc($result);		$art_quant = $art_quant['art_quantity'];				$p_quant = ceil($art_quant/$arperpage);					$ar_pages = array();					// предыдущая страница		$prev = ($curstart/$arperpage) - 1;		if($prev < 0){			$ar_pages["prev_start"] = null;		}else{			$ar_pages["prev_start"] = $prev*$arperpage;		}						// следующая страница		$next = ($curstart/$arperpage) + 1;		if($next == $p_quant){			$ar_pages["next_start"] = null;		}			else{			$ar_pages["next_start"] = $next*$arperpage;		}						for($i=1; $i<=$p_quant; $i++){		  $ar_pages[$i] = $arperpage*($i-1);	  		}    		return $ar_pages;	}	}